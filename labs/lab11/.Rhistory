##
## 1. Contingency tables and Chi-squared test
##
help(chisq.test)
dimnames(fake.tab) <- c(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
list
list
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
fake.tab <- as.table(fake.tab)
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=2, byrow=TRUE)
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=2, byrow=TRUE)
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=2, byrow=TRUE) #by row then col
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
fake.tab <- as.table(fake.tab)
fake.tab
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=3, byrow=TRUE) #by row then col
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
fake.tab <- as.table(fake.tab)
fake.tab
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=3, byrow=TRUE) #by row then col
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=2, byrow=TRUE) #by row then col
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
fake.tab <- as.table(fake.tab)
fake.tab
# Chi-squared test
chisq.test(fake.tab)
dim(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
# Let's make a fake contingency table for gender and party ID
fake.tab <- matrix(c(762, 327, 468, 484, 239, 677), nrow=2, byrow=TRUE) #by row then col since
dimnames(fake.tab) <- list(Gender=c("Female", "Male"),
Party=c("Democrat", "Independent", "Republican"))
fake.tab <- as.table(fake.tab)
fake.tab
# Chi-squared test
chisq.test(fake.tab)
# Chi-squared test
chisq.test(fake.tab)
##
## 3. Odds ratios
##
z.test()
# Read and inspect the data
cancer <- read.csv(url("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter09/chap09e2AspirinCancer.csv"))
head(cancer)
head(cancer)
# Read and inspect the data
cancer <- read.csv(url("http://whitlockschluter.zoology.ubc.ca/wp-content/data/chapter09/chap09e2AspirinCancer.csv"))
# create table between cancer and treatment
cancerTable <- table(cancer$cancer, cancer$aspirinTreatment)
# open plot
mosaicplot( t(cancerTable), col = c("blue", "goldenrod1"),
cex.axis = 1, sub = "Aspirin treatment", ylab = "Relative frequency", main = "")
# if you don't have this library, install it
if (!require("epitools")) {install.packages("epitools", dependencies = TRUE, repos="http://cran.rstudio.com/")}
library(epitools)
# Last, create 95% confidence interval
Z <- qnorm(1 - 0.05/2)
# when rounded, is 1.96
# create lower and upper bound
ciLnOR <- c(log(orHat) - Z * seLnOR, log(orHat) + Z * seLnOR)
# First, assign the labels a,b,c, and d to the table
# Then plug the values into the formula for odds ratio
x <- as.vector(cancerTable)
names(x) <- c("a","c","b","d")
orHat <- as.numeric((x["a"] * x["d"]) / (x["b"] * x["c"]))
orHat
x
orHat
orHat <- as.numeric((x["a"] * x["d"]) / (x["b"] * x["c"]))
orHat
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
convict.tab <- matrix(c(3150, 230, 516, 2984), nrow=2, byrow=TRUE)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
convict.tab
convict.tab= table(convict.tab)
convict.tab
convict.tab= un.table(convict.tab)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
convict.tab <- matrix(c(3150, 230, 516, 2984), nrow=2, byrow=TRUE)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
chisq.test(fake.tab)
chisq.test(convict.tab)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
conv
convict.tab
abort.tab
abort.tab = table(abort.tab)
abort.tab
?table
abort.tab = as.table(abort.tab)
abort.tab
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
abort.tab = as.table(abort.tab)
abort.tab
chisq.test(abort.tab)
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
chisq.test(abort.tab)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
chisq.test(abort.tab)
abort.tab = as.table(abort.tab)#contingency table
chisq.test(abort.tab)
abort.tab
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
abort.tab
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
chisq.test(abort.tab)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
abort.tab = as.table(abort.tab)#contingency table
chisq.test(abort.tab)
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
chisq.test(abort.tab)
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
chisq.test(abort.tab)
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
abort.tab = as.table(abort.tab)#contingency table
chisq.test(abort.tab)
abort.tab
abort.tab = as.table(abort.tab)#contingency table
abort.tab
# here is the data
abort.tab <- matrix(c(222, 225, 201, 277, 113, 223, 18, 12), nrow=4, byrow=TRUE)
dimnames(abort.tab) <- list(Party=c("Democrat", "Independent", "Republican", "Other"),
Opinion=c("Yes", "No"))
abort.tab
convict.tab <- matrix(c(3150, 230, 516, 2984), nrow=2, byrow=TRUE)
source('~/Documents/GitHub/QPMspring2019/labs/lab11/lab11.R', echo=TRUE)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
convict.tab
chisq.test(convict.tab)
oddsratio(convict.tab)
convict.tab <- matrix(c(3150, 230, 516, 2984), nrow=2, byrow=TRUE)
dimnames(convict.tab) <- list(Offender=c("White", "Black"),
Defendant=c("White", "Black"))
dimnames(convict.tab) <- list(Offender=c("WhiteOf", "BlackOf"),
Defendant=c("WhiteDe", "BlackDe"))
convict.tab
oddsratio(convict.tab)
oddsratio(convict.tab$WhiteOf)
oddsratio(convict.tab)
dimnames(convict.tab) <- list(Offender=c("WhiteOf", "BlackOf"),
Victim=c("WhiteDe", "BlackDe"))
dimnames(convict.tab) <- list(Offender=c("WhiteOf", "BlackOf"),
Victim=c("WhiteVict", "BlackVict"))
convict.tab
convict.tab
convict.tab
